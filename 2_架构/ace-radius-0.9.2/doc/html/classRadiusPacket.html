<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ace-radius: RadiusPacket Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7-20040704 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>RadiusPacket Class Reference</h1>Implementation of RADIUS packet.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="RadiusPacket_8h-source.html">RadiusPacket.h</a>&gt;</code>
<p>
<a href="classRadiusPacket-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a0">RadiusPacket</a> (unsigned char p_code, <a class="el" href="classRadiusClientStack.html">RadiusClientStack</a> &amp;p_stack)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a1">RadiusPacket</a> (unsigned char p_code, <a class="el" href="classRadiusPacket.html">RadiusPacket</a> &amp;p_request)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a2">RadiusPacket</a> (unsigned char p_code)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a3" doxytag="RadiusPacket::RadiusPacket" ></a>
&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a3">RadiusPacket</a> (const <a class="el" href="classRadiusPacket.html">RadiusPacket</a> &amp;p_packet)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a4" doxytag="RadiusPacket::~RadiusPacket" ></a>
&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a4">~RadiusPacket</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a5">getCode</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet code.  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a6" doxytag="RadiusPacket::getCodeDescription" ></a>
const char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a6">getCodeDescription</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet code description. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>uint16_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a7">getLength</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet length.  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a8">getID</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet identifier.  <a href="#a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a9">setID</a> (unsigned char p_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set packet identifier.  <a href="#a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a10" doxytag="RadiusPacket::randomID" ></a>
void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a10">randomID</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set random packet identifier. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classRadiusSecret.html">RadiusSecret</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a11">getSecret</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get secret key used for packet encoding.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a12">setSecret</a> (<a class="el" href="classRadiusSecret.html">RadiusSecret</a> *p_secret)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set secret key used for packet encoding.  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a13" doxytag="RadiusPacket::getAuthenticator" ></a>
const unsigned char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a13">getAuthenticator</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet authenticator. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a14" doxytag="RadiusPacket::setAuthenticator" ></a>
void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a14">setAuthenticator</a> (const unsigned char *p_auth)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set packet authenticator. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a15" doxytag="RadiusPacket::dump" ></a>
void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a15">dump</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump radius packet in readable text format to the STDOUT. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a16">getFirstAttribute</a> (<a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;p_attr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get first attribute in the packet.  <a href="#a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a17">getNextAttribute</a> (<a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;p_attr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get next attribute in the packet.  <a href="#a17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a18">findAttribute</a> (unsigned char p_attrType, <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;p_attr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find specific attribute in the packet.  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a19">addAttribute</a> (unsigned char p_attrType, <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;p_attr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add new attribute to the packet.  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a20" doxytag="RadiusPacket::getRawData" ></a>
unsigned char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a20">getRawData</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get raw packet data. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a21">adjustLength</a> (uint16_t p_length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adjust packet's length.  <a href="#a21"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a22">responseAuthenticator</a> (<a class="el" href="classRadiusSecret.html">RadiusSecret</a> *p_secret=NULL)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate authenticator for response packet.  <a href="#a22"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a24">accountingRequestAuthenticator</a> (<a class="el" href="classRadiusSecret.html">RadiusSecret</a> *p_secret=NULL)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate authenticator for accounting request packet.  <a href="#a24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a25" doxytag="RadiusPacket::verifyResponse" ></a>
bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#a25">verifyResponse</a> (<a class="el" href="classRadiusPacket.html">RadiusPacket</a> &amp;p_packet)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify RADIUS response. <br></td></tr>
<tr><td colspan=2><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="d0" doxytag="RadiusPacket::init" ></a>
void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#d0">init</a> (unsigned char p_code)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init packet. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="d1" doxytag="RadiusPacket::randomAuthenticator" ></a>
void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#d1">randomAuthenticator</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate pseudo-random authenticator. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#d2">setCode</a> (unsigned char p_code)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set packet's code.  <a href="#d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#d3">setLength</a> (uint16_t p_length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set packet's length.  <a href="#d3"></a><br></td></tr>
<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="r0" doxytag="RadiusPacket::m_data" ></a>
unsigned char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#r0">m_data</a> [D_RAW_DATA_LENGTH]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Raw packet data. <br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="r1" doxytag="RadiusPacket::m_secret" ></a>
<a class="el" href="classRadiusSecret.html">RadiusSecret</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classRadiusPacket.html#r1">m_secret</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">RADIUS secret associated with this packet. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of RADIUS packet. 
<p>
RadiusPacket class is responsible for holding data transferred to/from the network and providing simple interface to build new outgoing RADIUS packet and to parse incoming packet. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="RadiusPacket::RadiusPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RadiusPacket::RadiusPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>p_code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classRadiusClientStack.html">RadiusClientStack</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>p_stack</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>
This constructor should be used for constructing RADIUS requests (i.e. by RADIUS client application). It automatically generates random Authenticator, however application may override this later on by calling <a class="el" href="classRadiusPacket.html#a14">setAuthenticator()</a> method.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_code</em>&nbsp;</td><td>- packet code </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="RadiusPacket::RadiusPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RadiusPacket::RadiusPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>p_code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classRadiusPacket.html">RadiusPacket</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>p_request</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>
This constructor should be used for constructing RADIUS responses (i.e. by RADIUS server application). Original RADIUS request should be passed as parameter to it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_code</em>&nbsp;</td><td>- packet code </td></tr>
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_request</em>&nbsp;</td><td>- original RADIUS request packet </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="RadiusPacket::RadiusPacket" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> RadiusPacket::RadiusPacket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_code</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor. 
<p>
This constructor should be used for constructing RADIUS requests. It automatically generates random Authenticator, however application may override this later on by calling <a class="el" href="classRadiusPacket.html#a14">setAuthenticator()</a> method.<p>
Most applications should use the former constructors instead of this one. If for any reason you decide to use this constructor, make sure to update packet's identifier (by default packet will have zero ID).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_code</em>&nbsp;</td><td>- packet code </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a5" doxytag="RadiusPacket::getCode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned char RadiusPacket::getCode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get packet code. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>packet code </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="RadiusPacket::getLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> uint16_t RadiusPacket::getLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get packet length. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>packet length </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="RadiusPacket::getID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned char RadiusPacket::getID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get packet identifier. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>packet identifier </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="RadiusPacket::setID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::setID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_id</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set packet identifier. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_id</em>&nbsp;</td><td>- packet identifier </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="RadiusPacket::getSecret" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classRadiusSecret.html">RadiusSecret</a> * RadiusPacket::getSecret           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get secret key used for packet encoding. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>secret key </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="RadiusPacket::setSecret" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::setSecret           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classRadiusSecret.html">RadiusSecret</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_secret</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set secret key used for packet encoding. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_secret</em>&nbsp;</td><td>- secret key </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="RadiusPacket::getFirstAttribute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RadiusPacket::getFirstAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_attr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get first attribute in the packet. 
<p>
Updates p_attr to point at the first attribute in the packet. If packet has no attributes "invalid" attribute is returned.<p>
Typical code that goes over all attributes in the packet looks as follows: <div class="fragment"><pre>     <a class="code" href="classRadiusAttribute.html">RadiusAttribute</a> l_attr;
     <span class="keywordflow">for</span> (packet-&gt;getFirstAttribute(l_attr); 
          l_attr.<a class="code" href="classRadiusAttribute.html#a11">isValid</a>(); 
          packet-&gt;getNextAttribute(l_attr))
     {
         <span class="comment">// do something with the attribute</span>
     }
</pre></div<p>
Application can analyze return code or use isValid() method of <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> to verify validity of the returned attribute.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[out]</tt>&nbsp;</td><td valign=top><em>p_attr</em>&nbsp;</td><td>- first attribute in the packet </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>RC_SUCCESS or RC_FAIL </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="RadiusPacket::getNextAttribute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RadiusPacket::getNextAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_attr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get next attribute in the packet. 
<p>
Updates p_attr to point at the next attribute in the packet after the one that it was pointing at prior to calling this function. If no more attributes are found "invalid" attribute is returned.<p>
Application can analyze return code or use isValid() method of <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> to verify validity of the returned attribute.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in,out]</tt>&nbsp;</td><td valign=top><em>p_attr</em>&nbsp;</td><td>- input - current attribute; output - next attribute </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>RC_SUCCESS or RC_FAIL </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="RadiusPacket::findAttribute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RadiusPacket::findAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>p_attrType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>p_attr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find specific attribute in the packet. 
<p>
Updates p_attr to point at the first attribute of specified type in the packet. If attribute is not found "invalid" attribute is returned. If more than one instance of the same attribute exist in the packet, application should use <a class="el" href="classRadiusPacket.html#a17">getNextAttribute()</a> interface to retrieve them.<p>
Application can analyze return code or use isValid() method of <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> to verify validity of the returned attribute.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in,out]</tt>&nbsp;</td><td valign=top><em>p_attr</em>&nbsp;</td><td>- input - current attribute; output - next attribute </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>RC_SUCCESS or RC_FAIL </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="RadiusPacket::addAttribute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RadiusPacket::addAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>p_attrType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>p_attr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add new attribute to the packet. 
<p>
Updates p_attr to point at the free space in the packet. Returns <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> structure should be used by application in order to set attribute's value. If packet is full, "invalid" attribute is returned.<p>
Actual attribute's data is not encoded into the packet until proper attribute's set() method is called. So if application calls <a class="el" href="classRadiusPacket.html#a19">addAttribute()</a> and then suddenly changes it's mind, it's perfectly OK to simply call <a class="el" href="classRadiusPacket.html#a19">addAttribute()</a> again or send the packet "as is".<p>
Application can analyze return code or use isValid() method of <a class="el" href="classRadiusAttribute.html">RadiusAttribute</a> to verify validity of the returned attribute.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_attrType</em>&nbsp;</td><td>- attribute type </td></tr>
    <tr><td><tt>[out]</tt>&nbsp;</td><td valign=top><em>p_attr</em>&nbsp;</td><td>- reference to the added attribute </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>RC_SUCCESS or RC_FAIL </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="RadiusPacket::adjustLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RadiusPacket::adjustLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_length</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adjust packet's length. 
<p>
Adjust (increase) packet's length by specified number of bytes. If packet has not enough space to accomodate requested data, RC_FAIL is returned.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_length</em>&nbsp;</td><td>- how many bytes should be added to the packet </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>RC_SUCCESS or RC_FAIL </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="RadiusPacket::responseAuthenticator" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::responseAuthenticator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classRadiusSecret.html">RadiusSecret</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_secret</em> = <code>NULL</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate authenticator for response packet. 
<p>
Packet's authenticator should be initially set to the request's authenticator. This method should be called once only - prior to sending the packet over the network. Usually RadiusServer does the job, so user application doesn't have to bother.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_secret</em>&nbsp;</td><td>- secret key (if NULL, stack's secret key is taken) </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="RadiusPacket::accountingRequestAuthenticator" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::accountingRequestAuthenticator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classRadiusSecret.html">RadiusSecret</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_secret</em> = <code>NULL</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate authenticator for accounting request packet. 
<p>
Packet's attributes should be ready before calling This method should be called once only - prior to sending the packet over the network. Usually <a class="el" href="classRadiusClientStack.html">RadiusClientStack</a> does the job, so user application doesn't have to bother.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_secret</em>&nbsp;</td><td>- secret key (if NULL, stack's secret key is taken) </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="RadiusPacket::setCode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::setCode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_code</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set packet's code. 
<p>
Set packet's code. This method is intentionally put into the private section, since application should pass packet's code to RadiusPacket constructor.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_code</em>&nbsp;</td><td>- packet code </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="d3" doxytag="RadiusPacket::setLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void RadiusPacket::setLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint16_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p_length</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set packet's length. 
<p>
Set packet's length<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td><tt>[in]</tt>&nbsp;</td><td valign=top><em>p_length</em>&nbsp;</td><td>- packet's length </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li>ace-radius/<a class="el" href="RadiusPacket_8h-source.html">RadiusPacket.h</a><li>ace-radius/RadiusPacket.cpp</ul>
<hr size="1"><address style="align: right;"><small>Generated on Tue Aug 11 18:35:07 2009 for ace-radius by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7-20040704 </small></address>
</body>
</html>
