<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ace-radius: ace-radius/RadiusAttribute.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7-20040704 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>ace-radius/RadiusAttribute.h</h1><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment"> * This source file is part of the ace-radius library.  This code was</span>
00003 <span class="comment"> * written by Alex Agranov in 2004-2009, and is covered by the BSD open source</span>
00004 <span class="comment"> * license. Refer to the accompanying documentation for details on usage and</span>
00005 <span class="comment"> * license.</span>
00006 <span class="comment"> */</span>
00007 
00008 <span class="preprocessor">#ifndef _RADIUSATTRIBUTE_H__</span>
00009 <span class="preprocessor"></span><span class="preprocessor">#define _RADIUSATTRIBUTE_H__</span>
00010 <span class="preprocessor"></span>
00011 <span class="preprocessor">#include "Radius.h"</span>
00012 
00013 <span class="comment">// definition of Attribute Types from RFC2865</span>
00014 <span class="preprocessor">#define D_ATTR_USER_NAME                1</span>
00015 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_USER_PASSWORD            2</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CHAP_PASSWORD            3</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_NAS_IP_ADDRESS           4</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_NAS_PORT                 5</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_SERVICE_TYPE             6</span>
00020 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_PROTOCOL          7</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_IP_ADDRESS        8</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_IP_NETMASK        9</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_ROUTING           10 </span>
00024 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FILTER_ID                11 </span>
00025 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_MTU               12 </span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_COMPRESSION       13 </span>
00027 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_IP_HOST            14 </span>
00028 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_SERVICE            15 </span>
00029 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_TCP_PORT           16 </span>
00030 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_OLD_PASSWORD             17</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_REPLY_MESSAGE            18 </span>
00032 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CALLBACK_NUMBER          19 </span>
00033 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CALLBACK_ID              20 </span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_ROUTE             22 </span>
00035 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_IPX_NETWORK       23 </span>
00036 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_STATE                    24 </span>
00037 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CLASS                    25 </span>
00038 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_VENDOR_SPECIFIC          26 </span>
00039 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_SESSION_TIMEOUT          27 </span>
00040 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_IDLE_TIMEOUT             28 </span>
00041 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_TERMINATION_ACTION       29 </span>
00042 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CALLED_STATION_ID        30 </span>
00043 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_CALLING_STATION_ID       31 </span>
00044 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_NAS_IDENTIFIER           32 </span>
00045 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_PROXY_STATE              33 </span>
00046 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_LAT_SERVICE        34 </span>
00047 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_LAT_NODE           35 </span>
00048 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_LAT_GROUP          36 </span>
00049 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_APPLETALK_LINK    37 </span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_APPLETALK_NETWORK 38 </span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_FRAMED_APPLETALK_ZONE    39 </span>
00052 <span class="preprocessor"></span><span class="comment">// types 40-59 are reserved for accounting - RFC2866</span>
00053 <span class="preprocessor">#define D_ATTR_CHAP_CHALLENGE           60 </span>
00054 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_NAS_PORT_TYPE            61 </span>
00055 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_PORT_LIMIT               62 </span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_LOGIN_LAT_PROMPT         63</span>
00057 <span class="preprocessor"></span>
00058 <span class="comment">// definition of Attribute Types from RFC2866</span>
00059 <span class="preprocessor">#define D_ATTR_ACCT_STATUS_TYPE         40 </span>
00060 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_DELAY_TIME          41 </span>
00061 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_INPUT_OCTETS        42 </span>
00062 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_OUTPUT_OCTETS       43 </span>
00063 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_SESSION_ID          44 </span>
00064 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_AUTHENTIC           45 </span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_SESSION_TIME        46 </span>
00066 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_INPUT_PACKETS       47 </span>
00067 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_OUTPUT_PACKETS      48 </span>
00068 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_TERMINATE_CAUSE     49 </span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_MULTI_SESSION_ID    50 </span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define D_ATTR_ACCT_LINK_COUNT          51 </span>
00071 <span class="preprocessor"></span>
00072 <span class="preprocessor">#define D_ATTR_MAX_KNOWN_TYPE           63</span>
00073 <span class="preprocessor"></span>
00074 
00075 
00076 <span class="comment">// definition of Acct-Status-Type attribute values from RFC2866</span>
00077 <span class="preprocessor">#define D_ACCT_STATUS_START             1</span>
00078 <span class="preprocessor"></span><span class="preprocessor">#define D_ACCT_STATUS_STOP              2</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#define D_ACCT_STATUS_INTERIM_UPDATE    3</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#define D_ACCT_STATUS_ON                7</span>
00081 <span class="preprocessor"></span><span class="preprocessor">#define D_ACCT_STATUS_OFF               8</span>
00082 <span class="preprocessor"></span>
00083 
00084 <span class="comment">// max length of User-Password attribute</span>
00085 <span class="preprocessor">#define D_USER_PASSWORD_MAX_LENGTH    128</span>
00086 <span class="preprocessor"></span>
00087 
00088 
00089 <span class="keyword">class </span><a class="code" href="classRadiusPacket.html">RadiusPacket</a>;
00090 <span class="keyword">class </span><a class="code" href="classRadiusSecret.html">RadiusSecret</a>;
00091 
<a name="l00107"></a><a class="code" href="classRadiusAttribute.html">00107</a> <span class="keyword">class </span><a class="code" href="classRadiusAttribute.html">RadiusAttribute</a>
00108 {
00109 <span class="keyword">public</span>:
00110 
00112     <a class="code" href="classRadiusAttribute.html#a0">RadiusAttribute</a>();
00113     
00115     <a class="code" href="classRadiusAttribute.html#a1">~RadiusAttribute</a>();
00116 
00117     
00119     <span class="keywordtype">void</span> <a class="code" href="classRadiusAttribute.html#a2">dump</a>();
00120 
00121     
00123 
00131     <span class="keywordtype">void</span> <a class="code" href="classRadiusAttribute.html#a3">init</a>(<a class="code" href="classRadiusPacket.html">RadiusPacket</a> * p_packet, uint16_t p_offset);
00132 
00133     
00135     <a class="code" href="classRadiusPacket.html">RadiusPacket</a> * <a class="code" href="classRadiusAttribute.html#a4">getPacket</a>(<span class="keywordtype">void</span>);
00136 
00137 
00139     uint16_t <a class="code" href="classRadiusAttribute.html#a5">getOffset</a>(<span class="keywordtype">void</span>);
00140 
00141 
00143 
00145 
00148     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classRadiusAttribute.html#a6">getType</a>(<span class="keywordtype">void</span>);
00149 
00151 
00157     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a7">setType</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_type);
00158 
00159     
00161     <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classRadiusAttribute.html#a8">getTypeDescription</a>(<span class="keywordtype">void</span>);
00162 
00163 
00165 
00174     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classRadiusAttribute.html#a9">getLength</a>(<span class="keywordtype">void</span>);
00175 
00177 
00183     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a10">setLength</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_length);
00184 
00185     
00187 
00190     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a11">isValid</a>(<span class="keywordtype">void</span>);
00191 
00192 
00193     <span class="comment">// ------------------------------------------------------------</span>
00194     <span class="comment">// get- and set- methods - access data stored in the attribute</span>
00195 
00196     <span class="comment">// ===========================</span>
00197     <span class="comment">// Regular attributes</span>
00198     <span class="comment">// ===========================</span>
00199 
00201 
00204     uint32_t <a class="code" href="classRadiusAttribute.html#a12">getNumber</a>(<span class="keywordtype">void</span>);
00205     
00207 
00211     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a13">setNumber</a>(uint32_t p_value);
00212 
00213 
00215 
00218     <span class="keyword">struct </span>in_addr getIPAddress(void);
00219 
00221 
00225     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a15">setIPAddress</a>(<span class="keyword">struct</span> in_addr p_value);
00226 
00227 
00229 
00239     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a16">getString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * &amp; p_data, uint16_t &amp; p_length);
00240     
00242 
00257     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a17">setString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00258 
00259 
00260     <span class="comment">// ===========================</span>
00261     <span class="comment">// Vendor-Specific attribute</span>
00262     <span class="comment">// ===========================</span>
00263 
00265 
00268     uint32_t <a class="code" href="classRadiusAttribute.html#a18">getVendorId</a>(<span class="keywordtype">void</span>);
00269     
00271 
00275     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a19">setVendorId</a>(uint32_t p_vendorId);
00276 
00278 
00294     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a20">getVendorRawString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * &amp; p_data, uint16_t &amp; p_length);
00295     
00297 
00318     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a21">setVendorRawString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00319 
00320 
00322 
00325         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classRadiusAttribute.html#a22">getVendorType</a>();
00326 
00328 
00332         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a23">setVendorType</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_value);
00333 
00334 
00336 
00339         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classRadiusAttribute.html#a24">getVendorLength</a>();
00340 
00342 
00346         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a25">setVendorLength</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_length);
00347 
00348 
00350 
00353         uint32_t <a class="code" href="classRadiusAttribute.html#a26">getVendorNumber</a>();
00354     
00356 
00360         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a27">setVendorNumber</a>(uint32_t p_value);
00361 
00362 
00364 
00367         <span class="keyword">struct </span>in_addr getVendorIPAddress();   
00368 
00370 
00374         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a29">setVendorIPAddress</a>(<span class="keyword">struct</span> in_addr p_address);
00375 
00376 
00378 
00388         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a30">getVendorString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * &amp; p_data, uint16_t &amp; p_length);
00389     
00391 
00409         <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a31">setVendorString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00410 
00411 
00412     <span class="comment">// ===========================</span>
00413     <span class="comment">// User-Password attribute</span>
00414     <span class="comment">// ===========================</span>
00415     
00417 
00436     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a32">getUserPassword</a>(<span class="keywordtype">char</span> * p_data, uint16_t &amp; p_length, 
00437                         <a class="code" href="classRadiusSecret.html">RadiusSecret</a> * p_secret = NULL);
00438     
00440 
00461     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a33">setUserPassword</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00462 
00463     <span class="comment">// Encode raw data of User-Password attribute</span>
00464     <span class="comment">/*</span>
00465 <span class="comment">     * We need this function in order to re-encode User-Password attribute with new secret key</span>
00466 <span class="comment">     * when packet is retransmitted through new connection; application should not use this API.</span>
00467 <span class="comment">     */</span>
00468     <span class="keywordtype">int</span> encodeUserPassword(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length);
00469 
00470 
00471     <span class="comment">// ===========================</span>
00472     <span class="comment">// Old-Password attribute</span>
00473     <span class="comment">// ===========================</span>
00474 
00476 
00495     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a35">getOldPassword</a>(<span class="keywordtype">char</span> * p_data, uint16_t &amp; p_length, 
00496                         <a class="code" href="classRadiusSecret.html">RadiusSecret</a> * p_secret = NULL);
00497 
00499 
00524     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a36">setOldPassword</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00525 
00526     <span class="comment">// Encode raw data of Old-Password attribute</span>
00527     <span class="comment">/*</span>
00528 <span class="comment">     * We need this function in order to re-encode User-Password attribute with new secret key</span>
00529 <span class="comment">     * when packet is retransmitted through new connection; application should not use this API.</span>
00530 <span class="comment">     */</span>
00531     <span class="keywordtype">int</span> encodeOldPassword(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length);
00532 
00533 
00534     <span class="comment">// ===========================</span>
00535     <span class="comment">// CHAP-Password attribute</span>
00536     <span class="comment">// ===========================</span>
00537 
00539 
00542     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classRadiusAttribute.html#a38">getChapIdentifier</a>(<span class="keywordtype">void</span>);
00543     
00545 
00549     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a39">setChapIdentifier</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> p_chapId);
00550 
00552 
00562     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a40">getChapString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * &amp; p_data, uint16_t &amp; p_length);
00563     
00565 
00579     <span class="keywordtype">int</span> <a class="code" href="classRadiusAttribute.html#a41">setChapString</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * p_data, uint16_t p_length = 0);
00580 
00581 
00582 
00583 <span class="keyword">private</span>:
00584 
00585     <span class="comment">// Get pointer to the attribute raw data</span>
00586     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * getRawData(<span class="keywordtype">void</span>);
00587 
00588     <span class="comment">// Types of attribute data</span>
00589     <span class="keyword">typedef</span> <span class="keyword">enum</span> AttributeFormat_e
00590     {
00591         E_ATTR_FORMAT_INTEGER,
00592         E_ATTR_FORMAT_IP_ADDRESS,
00593         E_ATTR_FORMAT_STRING,
00594         E_ATTR_FORMAT_VENDOR_SPECIFIC,
00595         E_ATTR_FORMAT_USER_PASSWORD,
00596         E_ATTR_FORMAT_CHAP_PASSWORD
00597     };
00598 
00599     <span class="comment">// Dump attribute in readable text format to the STDOUT</span>
00603 <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classRadiusAttribute.html#a2">dump</a>(AttributeFormat_e p_format);
00604 
00606 
00607     <span class="comment">// Pointer to the RADIUS packet that this attribute belongs to</span>
00608     <a class="code" href="classRadiusPacket.html">RadiusPacket</a> * m_packet;
00609 
00610     <span class="comment">// Offset of the attribute inside the RADIUS packet</span>
00611     uint16_t m_offset;
00612 };
00613 
00614 <span class="preprocessor">#endif // _RADIUSATTRIBUTE_H__</span>
00615 <span class="preprocessor"></span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Tue Aug 11 18:35:06 2009 for ace-radius by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7-20040704 </small></address>
</body>
</html>
